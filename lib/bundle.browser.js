!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).achieve={})}(this,(function(e){"use strict";let t,r=[];const n=e=>{for(let t=0;t<e.deps.length;t++){e.deps[t].delete(e)}e.deps.length=0},o={};["includes","indexOf","lastIndexOf"].forEach((e=>{const t=Array.prototype[e];o[e]=function(...e){let r=t.apply(this,e);return r||(r=t.apply(this.raw,e)),r}}));let s=!1;const c={};["push","pop","shift","unshift","splice"].forEach((e=>{const t=Array.prototype[e];c[e]=function(...e){s=!0;const r=t.apply(this,e);return s=!1,r}}));let l=new WeakMap,f=Symbol();const a="ADD",u="SET",i="DEL",p="length",y=(e=!1,t=!1)=>({get(r,n,s){if(console.log("get:",n),"raw"===n)return r;if(Array.isArray(r)&&o.hasOwnProperty(n))return Reflect.get(o,n,s);if(Array.isArray(r)&&c.hasOwnProperty(n))return Reflect.get(c,n,s);t||"symbol"==typeof n||h(r,n);const l=Reflect.get(r,n,s);return e?l:"object"==typeof l&&null!==l?t?A(l):R(l):l},set(e,r,n,o){if(console.log("set:",r),t)return console.warn("当前为只读对象，不可编辑！"),!1;const s=e[r],c=Array.isArray(e)?Number(r)>e[p]-1?a:u:Object.prototype.hasOwnProperty.call(e,r)?u:a,l=Reflect.set(e,r,n,o);return e===o.raw&&(s===n||s!=s&&n!=n||d(e,r,c,n)),l},has:(e,t)=>(h(e,t),Reflect.has(e,t)),deleteProperty(e,r){if(t)return console.warn("当前为只读对象，不可删除！"),!1;const n=Object.prototype.hasOwnProperty.call(e,r),o=Reflect.deleteProperty(e,r);return n&&o&&d(e,r,i),o},ownKeys(e){const t=Array.isArray(e)?p:f;return h(e,t),Reflect.ownKeys(e)}}),h=(e,r)=>{if(!t||s)return e[r];let n=l.get(e);n||l.set(e,n=new Map);let o=n.get(r);o||n.set(r,o=new Set),o.add(t),t.deps.push(o)},d=(e,r,n,o)=>{console.log("type",n);const s=l.get(e);if(!s)return;const c=s.get(r),u=new Set,y=e=>{e&&e.forEach((e=>{e!==t&&u.add(e)}))};if(y(c),n===a||n===i){const e=s.get(f);y(e)}if(n===a&&Array.isArray(e)){console.log("01");const e=s.get(p);y(e)}Array.isArray(e)&&r===p&&(console.log("02"),s.forEach(((e,t)=>{t>=o&&y(e)}))),u.forEach((e=>{e.options.scheduler?e.options.scheduler(e):e()}))};function g(e,t=!1,r=!1){return new Proxy(e,y(t,r))}let w=new Map;function R(e){const t=w.get(e);if(t)return t;const r=g(e);return w.set(e,r),r}function A(e){return g(e,!1,!0)}const v=(e,t)=>{const r={get value(){return e[t]},set value(r){e[t]=r}};return Object.defineProperty(r,"__v_isRef",{value:!0}),console.log("wrapper",r),r};e.effect=function(e,o={}){const s=()=>{n(s),t=s,r.push(t);const o=e();return r.pop(),t=r.at(-1),o};return s.options=o,s.deps=[],o.lazy||s(),s},e.proxyRef=e=>new Proxy(e,{get(e,t,r){const n=Reflect.get(e,t,r);return n.__v_isRef?n.value:n},set(e,t,r,n){const o=e[t];return o.__v_isRef?(o.value=r,!0):Reflect.set(e,t,r,n)}}),e.reactive=R,e.readOnly=A,e.ref=e=>{const t={value:e};return Object.defineProperty(t,"__v_isRef",{value:!0}),R(t)},e.shallowReactive=function(e){return g(e,!0)},e.shallowReadOnly=function(e){return g(e,!0,!0)},e.toRef=v,e.toRefs=e=>{let t={};return Object.keys(e).forEach((r=>{t[r]=v(e,r)})),t}}));
